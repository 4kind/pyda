{% extends "layout.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block page_content %}
    <a href="{{ url_for('passwords.add_password') }}"><span class="glyphicon glyphicon-plus"> Add password</span></a>
    {% if current_user.is_authenticated %}
        <div class="passwords">
            {% for password in passwords %}
                <div>
                    <h2><a href="{{ url_for('passwords.edit_password', id=password.id) }}">{{ password.title }}</a>
                        <a href="{{ url_for('passwords.delete_password', id=password.id) }}">
                            <span class="glyphicon glyphicon-trash"></span>
                        </a>
                    </h2>
                    {{ password.username|safe }}<br>
                    {{ password.password|safe }}<br>
                    {{ password.website|safe }}<br>
                    {{ password.description|safe }}
                    {% for message in get_flashed_messages(category_filter=['confirm']) %}
                        {% for password_id, message in message.items() %}
                            {% if password_id|int == password.id %}
                                <div id="confirm-delete" tabindex="-1" role="dialog">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-body">
                                                {{ message }}
                                            </div>
                                            <div class="modal-footer">
                                                <a class="btn btn-default btn-ok"
                                                   href="{{ url_for('passwords.show_passwords') }}">Cancel</a>
                                                <a class="btn btn-danger btn-ok"
                                                   href="{{ url_for('passwords.delete_password', id=password_id, confirm=1) }}">Delete</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endif %}
                        {% endfor %}
                    {% endfor %}
                </div>
            {% else %}
                <li><em>Unbelievable. No entries here so far</em></li>
            {% endfor %}
        </div>
    {% endif %}
{% endblock %}
